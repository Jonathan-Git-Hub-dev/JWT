create database JWT;

use JWT;
DROP TABLE User;
CREATE TABLE User (
    uId int NOT NULL AUTO_INCREMENT UNIQUE,
    uEmail varchar(100) NOT NULL UNIQUE,
    uPass varchar(200) COLLATE latin1_general_cs NOT NULL,
    salt varchar(30) COLLATE latin1_general_cs NOT NULL,
    resets INT DEFAULT 0,

    PRIMARY KEY (uId) 
);


DROP TABLE Incomplete_User;
CREATE TABLE Incomplete_User (
    uId int NOT NULL AUTO_INCREMENT UNIQUE,
    uEmail varchar(100) NOT NULL UNIQUE,
    uPass varchar(200) COLLATE latin1_general_cs NOT NULL,
    salt varchar(30) COLLATE latin1_general_cs NOT NULL,
    verificationCode varchar(6) NOT NULL,
    expiry BIGINT NOT NULL, 
    
    PRIMARY KEY (uId)
);

DROP TABLE Recover_User;
CREATE TABLE Recover_User (
    uEmail varchar(100) NOT NULL UNIQUE,
    verificationCode varchar(6) NOT NULL,
    expiry BIGINT NOT NULL,
    attempts INT DEFAULT 0,
    
    PRIMARY KEY (uEmail)
);


DROP TABLE Refresh_Tokens;
CREATE TABLE Refresh_Tokens (
    uId int NOT NULL UNIQUE,
    token BINARY(128) NOT NULL UNIQUE,
    secret BINARY(64) NOT NULL UNIQUE,
    expiry BIGINT NOT NULL,
    
    PRIMARY KEY (uId)
);


